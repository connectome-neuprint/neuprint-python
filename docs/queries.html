<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Queries &mdash; neuprint-python 0.5.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=2eda87d7" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=b9afe91b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Simulation" href="simulation.html" />
    <link rel="prev" title="Client" href="client.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            neuprint-python
          </a>
              <div class="version">
                0.5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#server-built-in-queries">Server Built-in Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rois">ROIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#neurons">Neurons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connectivity">Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synapses">Synapses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mitochondria">Mitochondria</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reconstruction-tools">Reconstruction Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">General</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">ROIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Neurons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Connectivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Synapses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Mitochondria</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Reconstruction Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="skeleton.html">Skeletons</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrangle.html">Data Wrangling</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="admin.html">Admin Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="related.html">Related Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">neuprint-python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API</a></li>
      <li class="breadcrumb-item active">Queries</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/queries.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="queries">
<span id="id1"></span><h1>Queries<a class="headerlink" href="#queries" title="Link to this heading">¶</a></h1>
<p>Convenience functions for common queries.</p>
<p>If you are familiar with the neuPrint data model and the
<a class="reference external" href="https://neo4j.com/developer/cypher-query-language/">cypher</a>
query language, you can write your own queries using
<a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom</span></code></a>.
But the functions in this file offer a convenient API for common queries.</p>
<section id="server-built-in-queries">
<h2>Server Built-in Queries<a class="headerlink" href="#server-built-in-queries" title="Link to this heading">¶</a></h2>
<p>See the <a class="reference internal" href="client.html#client"><span class="std std-ref">Client</span></a> class reference for the neuprint server’s built-in
(non-cypher) queries, such as <strong>skeletons</strong>, <strong>ROI meshes</strong>, <strong>ROI connectivity</strong>,
and server metadata.</p>
</section>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_custom</span></code></a>(cypher[, dataset, format, client])</p></td>
<td><p>Make a custom cypher query.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_meta" title="neuprint.queries.fetch_meta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_meta</span></code></a>(*[, client])</p></td>
<td><p>Fetch the dataset metadata.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rois">
<h2>ROIs<a class="headerlink" href="#rois" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_all_rois" title="neuprint.queries.fetch_all_rois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_all_rois</span></code></a>(*[, client])</p></td>
<td><p>List all ROIs in the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_primary_rois" title="neuprint.queries.fetch_primary_rois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_primary_rois</span></code></a>(*[, client])</p></td>
<td><p>List 'primary' ROIs in the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_roi_hierarchy" title="neuprint.queries.fetch_roi_hierarchy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_roi_hierarchy</span></code></a>([include_subprimary, ...])</p></td>
<td><p>Fetch the ROI hierarchy nesting relationships.</p></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="client.html#neuprint.client.Client.fetch_roi_completeness" title="neuprint.client.Client.fetch_roi_completeness"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Client.fetch_roi_completeness()</span></code></a></p></li>
<li><p><a class="reference internal" href="client.html#neuprint.client.Client.fetch_roi_connectivity" title="neuprint.client.Client.fetch_roi_connectivity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Client.fetch_roi_connectivity()</span></code></a></p></li>
</ul>
</div>
</section>
<section id="neurons">
<h2>Neurons<a class="headerlink" href="#neurons" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>([matchvar, bodyId, type, ...])</p></td>
<td><p>Neuron selection criteria.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_neurons" title="neuprint.queries.fetch_neurons"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_neurons</span></code></a>([criteria, omit_rois, client])</p></td>
<td><p>Return properties and per-ROI synapse counts for a set of neurons.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_custom_neurons</span></code></a>(q, *[, client])</p></td>
<td><p>Return properties and per-ROI synapse counts for a set of neurons, using your own cypher query.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="connectivity">
<h2>Connectivity<a class="headerlink" href="#connectivity" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_simple_connections</span></code></a>([...])</p></td>
<td><p>Find connections to/from small set(s) of neurons.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_adjacencies</span></code></a>([sources, targets, rois, ...])</p></td>
<td><p>Find connections to/from large sets of neurons, with per-ROI connection strengths.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_traced_adjacencies" title="neuprint.queries.fetch_traced_adjacencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_traced_adjacencies</span></code></a>([export_dir, ...])</p></td>
<td><p>Convenience function that calls <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a> for all <code class="docutils literal notranslate"><span class="pre">Traced</span></code>, non-<code class="docutils literal notranslate"><span class="pre">cropped</span></code> neurons.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_common_connectivity" title="neuprint.queries.fetch_common_connectivity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_common_connectivity</span></code></a>(criteria[, ...])</p></td>
<td><p>Find shared connections among a set of neurons.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_shortest_paths" title="neuprint.queries.fetch_shortest_paths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_shortest_paths</span></code></a>(upstream_bodyId, ...[, ...])</p></td>
<td><p>Find all neurons along the shortest path between two neurons.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="synapses">
<h2>Synapses<a class="headerlink" href="#synapses" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a>([matchvar, rois, type, ...])</p></td>
<td><p>Synapse selection criteria.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_synapses" title="neuprint.queries.fetch_synapses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_synapses</span></code></a>(neuron_criteria[, ...])</p></td>
<td><p>Fetch synapses from a neuron or selection of neurons.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_mean_synapses" title="neuprint.queries.fetch_mean_synapses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_mean_synapses</span></code></a>(neuron_criteria[, ...])</p></td>
<td><p>Fetch average synapse position and confidence for each neuron in set of neurons.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_synapse_connections" title="neuprint.queries.fetch_synapse_connections"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_synapse_connections</span></code></a>([source_criteria, ...])</p></td>
<td><p>Fetch synaptic-level connections between source and target neurons.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mitochondria">
<h2>Mitochondria<a class="headerlink" href="#mitochondria" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="mitocriteria.html#neuprint.queries.MitoCriteria" title="neuprint.queries.MitoCriteria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MitoCriteria</span></code></a>([matchvar, rois, mitoType, ...])</p></td>
<td><p>Mitochondrion selection criteria.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_mitochondria" title="neuprint.queries.fetch_mitochondria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_mitochondria</span></code></a>(neuron_criteria[, ...])</p></td>
<td><p>Fetch mitochondria from a neuron or selection of neurons.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_synapses_and_closest_mitochondria" title="neuprint.queries.fetch_synapses_and_closest_mitochondria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_synapses_and_closest_mitochondria</span></code></a>(...)</p></td>
<td><p>Fetch a set of synapses from a selection of neurons and also return their nearest mitocondria (by path-length within the neuron segment).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_connection_mitochondria" title="neuprint.queries.fetch_connection_mitochondria"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_connection_mitochondria</span></code></a>(...[, ...])</p></td>
<td><p>For a given set of source neurons and target neurons, find all synapse-level connections between the sources and targets, along with the nearest mitochondrion on the pre-synaptic side and the post-synaptic side.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reconstruction-tools">
<h2>Reconstruction Tools<a class="headerlink" href="#reconstruction-tools" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#neuprint.queries.fetch_output_completeness" title="neuprint.queries.fetch_output_completeness"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_output_completeness</span></code></a>(criteria[, ...])</p></td>
<td><p>Compute an estimate of &quot;output completeness&quot; for a set of neurons.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#neuprint.queries.fetch_downstream_orphan_tasks" title="neuprint.queries.fetch_downstream_orphan_tasks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_downstream_orphan_tasks</span></code></a>(criteria[, ...])</p></td>
<td><p>Fetch the set of &quot;downstream orphans&quot; for a given set of neurons.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3>General<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_custom">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cypher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pandas'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/general.py#L4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_custom" title="Link to this definition">¶</a></dt>
<dd><p>Make a custom cypher query.</p>
<p>Alternative form of <a class="reference internal" href="client.html#neuprint.client.Client.fetch_custom" title="neuprint.client.Client.fetch_custom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Client.fetch_custom()</span></code></a>, as a free function.
That is, <code class="docutils literal notranslate"><span class="pre">fetch_custom(...,</span> <span class="pre">client=c)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">c.fetch_custom(...)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">client=None</span></code>, the default <code class="docutils literal notranslate"><span class="pre">Client</span></code> is used
(assuming you have created at least one <code class="docutils literal notranslate"><span class="pre">Client</span></code>.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cypher</strong> – A cypher query string</p></li>
<li><p><strong>dataset</strong> – <p><em>Deprecated. Please provide your dataset as a Client constructor argument.</em></p>
<p>Which neuprint dataset to query against.
If None provided, the client’s default dataset is used.</p>
</p></li>
<li><p><strong>format</strong> – Either ‘pandas’ or ‘json’.
Whether to load the results into a pandas DataFrame,
or return the server’s raw json response as a Python dict.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either json or DataFrame, depending on <code class="docutils literal notranslate"><span class="pre">format</span></code>.</p>
</dd>
</dl>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_custom</span>
<span class="gp">   ...:</span>
<span class="gp">   ...: </span><span class="n">q</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="gp">   ...: </span><span class="s2">MATCH (n:Neuron)</span>
<span class="gp">   ...: </span><span class="s2">WHERE n.bodyId = 5813027016</span>
<span class="gp">   ...: </span><span class="s2">RETURN n.type, n.instance</span>
<span class="gp">   ...: </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">   ...: </span><span class="n">fetch_custom</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gh">Out[4]:</span>
<span class="go">  n.type      n.instance</span>
<span class="go">0   FB4Y  FB4Y(EB/NO1)_R</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_meta">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/general.py#L53"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_meta" title="Link to this definition">¶</a></dt>
<dd><p>Fetch the dataset metadata.
Parses json fields as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_meta</span>

<span class="gp">In [2]: </span><span class="n">meta</span> <span class="o">=</span> <span class="n">fetch_meta</span><span class="p">()</span>

<span class="gp">In [3]: </span><span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gh">Out[3]:</span>
<span class="go">[&#39;dataset&#39;,</span>
<span class="go"> &#39;info&#39;,</span>
<span class="go"> &#39;lastDatabaseEdit&#39;,</span>
<span class="go"> &#39;latestMutationId&#39;,</span>
<span class="go"> &#39;logo&#39;,</span>
<span class="go"> &#39;meshHost&#39;,</span>
<span class="go"> &#39;neuroglancerInfo&#39;,</span>
<span class="go"> &#39;neuroglancerMeta&#39;,</span>
<span class="go"> &#39;postHPThreshold&#39;,</span>
<span class="go"> &#39;postHighAccuracyThreshold&#39;,</span>
<span class="go"> &#39;preHPThreshold&#39;,</span>
<span class="go"> &#39;primaryRois&#39;,</span>
<span class="go"> &#39;roiHierarchy&#39;,</span>
<span class="go"> &#39;roiInfo&#39;,</span>
<span class="go"> &#39;statusDefinitions&#39;,</span>
<span class="go"> &#39;superLevelRois&#39;,</span>
<span class="go"> &#39;tag&#39;,</span>
<span class="go"> &#39;totalPostCount&#39;,</span>
<span class="go"> &#39;totalPreCount&#39;,</span>
<span class="go"> &#39;uuid&#39;]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id3">
<h3>ROIs<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_all_rois">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_all_rois</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/rois.py#L7"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_all_rois" title="Link to this definition">¶</a></dt>
<dd><p>List all ROIs in the dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_primary_rois">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_primary_rois</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/rois.py#L29"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_primary_rois" title="Link to this definition">¶</a></dt>
<dd><p>List ‘primary’ ROIs in the dataset.
Primary ROIs do not overlap with each other.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_roi_hierarchy">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_roi_hierarchy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_subprimary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_primary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dict'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/rois.py#L40"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_roi_hierarchy" title="Link to this definition">¶</a></dt>
<dd><p>Fetch the ROI hierarchy nesting relationships.</p>
<p>Most ROIs in neuprint are part of a hierarchy of nested regions.
The structure of the hierarchy is stored in the dataset metadata,
and can be retrieved with this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_subprimary</strong> – If True, all hierarchy levels are included in the output.
Otherwise, the hierarchy will only go as deep as necessary to
cover all “primary” ROIs, but not any sub-primary ROIs that
are contained within them.</p></li>
<li><p><strong>mark_primary</strong> – If True, append an asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>) to the names of
“primary” ROIs in the hierarchy.
Primary ROIs do not overlap with each other.</p></li>
<li><p><strong>format</strong> – Either <code class="docutils literal notranslate"><span class="pre">&quot;dict&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;text&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">nx</span></code>.
Specifies whether to return the hierarchy as a <cite>dict</cite>, or as
a printable text-based tree, or as a <code class="docutils literal notranslate"><span class="pre">networkx.DiGraph</span></code>
(requires <code class="docutils literal notranslate"><span class="pre">networkx</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, or <code class="docutils literal notranslate"><span class="pre">nx.DiGraph</span></code>,
depending on your chosen <code class="docutils literal notranslate"><span class="pre">format</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint.queries</span> <span class="kn">import</span> <span class="n">fetch_roi_hierarchy</span>
<span class="gp">   ...:</span>
<span class="gp">   ...: </span><span class="c1"># Print the first few nodes of the tree -- you get the idea</span>
<span class="gp">   ...: </span><span class="n">roi_tree_text</span> <span class="o">=</span> <span class="n">fetch_roi_hierarchy</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="nb">print</span><span class="p">(</span><span class="n">roi_tree_text</span><span class="p">[:</span><span class="mi">180</span><span class="p">])</span>
<span class="go">hemibrain</span>
<span class="go"> +-- AL(L)*</span>
<span class="go"> +-- AL(R)*</span>
<span class="go"> +-- AOT(R)</span>
<span class="go"> +-- CX</span>
<span class="go"> |   +-- AB(L)*</span>
<span class="go"> |   +-- AB(R)*</span>
<span class="go"> |   +-- EB*</span>
<span class="go"> |   +-- FB*</span>
<span class="go"> |   +-- NO*</span>
<span class="go"> |   +-- PB*</span>
<span class="go"> +-- GC</span>
<span class="go"> +-- GF(R)</span>
<span class="go"> +-- GNG*</span>
<span class="go"> +-- INP</span>
<span class="go"> |</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id4">
<h3>Neurons<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_neurons">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_rois</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/neurons.py#L18"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_neurons" title="Link to this definition">¶</a></dt>
<dd><p>Return properties and per-ROI synapse counts for a set of neurons.</p>
<p>Searches for a set of Neurons (or Segments) that match the given <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>.
Returns their properties, including the distibution of their synapses in all brain regions.</p>
<p>This implements a superset of the features on the Neuprint Explorer <a class="reference external" href="https://neuprint.janelia.org/?dataset=hemibrain%3Av1.2.1&amp;qt=findneurons&amp;q=1">Find Neurons</a> page.</p>
<p>Returns data in the the same format as <a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom_neurons()</span></code></a>,
but doesn’t require you to write cypher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Only Neurons which satisfy all components of the given criteria are returned.
If no criteria is specified then the default <code class="docutils literal notranslate"><span class="pre">NeuronCriteria()</span></code> is used.</p></li>
<li><p><strong>omit_rois</strong> (<em>bool</em>) – If True, the ROI columns are omitted from the output.
If you don’t need ROI information, this can speed up the query.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="docutils literal notranslate"><span class="pre">(neurons_df,</span> <span class="pre">roi_counts_df)</span></code> unless <code class="docutils literal notranslate"><span class="pre">omit_rois</span></code> is True,
in which case only <code class="docutils literal notranslate"><span class="pre">neurons_df</span></code> is returned.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">neurons_df</span></code>, all available <code class="docutils literal notranslate"><span class="pre">:Neuron</span></code> columns are returned, with the following changes:</p>
<blockquote>
<div><ul class="simple">
<li><p>ROI boolean columns are removed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> is parsed as json data</p></li>
<li><p>coordinates (such as <code class="docutils literal notranslate"><span class="pre">somaLocation</span></code>) are provided as a list <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span></code></p></li>
<li><p>New columns <code class="docutils literal notranslate"><span class="pre">input_rois</span></code> and <code class="docutils literal notranslate"><span class="pre">output_rois</span></code> contain lists of each neuron’s ROIs.</p></li>
</ul>
</div></blockquote>
<p>In <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>, the <code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> has been loadded into a table
of per-neuron-per-ROI synapse counts, with separate columns
for <code class="docutils literal notranslate"><span class="pre">pre</span></code> (outputs) and <code class="docutils literal notranslate"><span class="pre">post</span></code> (inputs).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>, the sum of the <code class="docutils literal notranslate"><span class="pre">pre</span></code> and <code class="docutils literal notranslate"><span class="pre">post</span></code> counts will be more than
the total <code class="docutils literal notranslate"><span class="pre">pre</span></code> and <code class="docutils literal notranslate"><span class="pre">post</span></code> values returned in <code class="docutils literal notranslate"><span class="pre">neuron_df</span></code>.
That is, synapses are double-counted (or triple-counted, etc.) in <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>.
This is because ROIs form a hierarchical structure, so each synapse intersects
more than one ROI. See <a class="reference internal" href="#neuprint.queries.fetch_roi_hierarchy" title="neuprint.queries.fetch_roi_hierarchy"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_roi_hierarchy()</span></code></a> for more information.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Connections which fall outside of all primary ROIs are listed via special entries
using <code class="docutils literal notranslate"><span class="pre">NotPrimary</span></code> in place of an ROI name.  The term <code class="docutils literal notranslate"><span class="pre">NotPrimary</span></code> is
introduced by this function. It isn’t used internally by the neuprint database.</p>
</div>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Two DataFrames</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neuprint.queries.fetch_custom_neurons" title="neuprint.queries.fetch_custom_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom_neurons()</span></code></a> produces similar output,
but permits you to supply your own cypher query directly.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_neurons</span><span class="p">,</span> <span class="n">NeuronCriteria</span> <span class="k">as</span> <span class="n">NC</span>

<span class="gp">In [2]: </span><span class="n">neurons_df</span><span class="p">,</span> <span class="n">roi_counts_df</span> <span class="o">=</span> <span class="n">fetch_neurons</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="n">NC</span><span class="p">(</span><span class="n">inputRois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SIP(R)&#39;</span><span class="p">,</span> <span class="s1">&#39;aL(R)&#39;</span><span class="p">],</span>
<span class="gp">   ...: </span>       <span class="n">status</span><span class="o">=</span><span class="s1">&#39;Traced&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>       <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;MBON.*&#39;</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">neurons_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="gh">Out[3]:</span>
<span class="go">      bodyId                     instance    type cellBodyFiber   pre   post        size  status  cropped     statusLabel  somaRadius</span>
<span class="go">0  300972942                 MBON14(a3)_R  MBON14           NaN   543  13634  1563154937  Traced    False  Roughly traced         NaN</span>
<span class="go">1  422725634        MBON06(B1&gt;a)(AVM07)_L  MBON06           NaN  1356  20978  3118269136  Traced    False  Roughly traced         NaN</span>
<span class="go">2  423382015        MBON23(a2sp)(PDL05)_R  MBON23          SFS1   733   4466   857093893  Traced    False  Roughly traced       291.0</span>
<span class="go">3  423774471       MBON19(a2p3p)(PDL05)_R  MBON19          SFS1   299   1484   628019179  Traced    False  Roughly traced       286.0</span>
<span class="go">4  424767514  MBON11(y1pedc&gt;a/B)(ADM05)_R  MBON11        mAOTU2  1643  27641  5249327644  Traced    False          Traced       694.5</span>

<span class="gp">In [4]: </span><span class="n">neurons_df</span><span class="p">[</span><span class="s1">&#39;inputRois&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[4]:</span>
<span class="go">0    [MB(+ACA)(R), MB(R), None, SIP(R), SLP(R), SMP...</span>
<span class="go">1    [CRE(-ROB,-RUB)(R), CRE(R), INP, MB(+ACA)(R), ...</span>
<span class="go">2    [MB(+ACA)(R), MB(R), None, SIP(R), SLP(R), SMP...</span>
<span class="go">3    [MB(+ACA)(R), MB(R), SIP(R), SMP(R), SNP(R), a...</span>
<span class="go">4    [CRE(-ROB,-RUB)(R), CRE(L), CRE(R), INP, MB(+A...</span>
<span class="go">Name: inputRois, dtype: object</span>

<span class="gp">In [5]: </span><span class="n">roi_counts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[5]:</span>
<span class="go">      bodyId          roi  pre   post</span>
<span class="go">0  300972942        MB(R)   17  13295</span>
<span class="go">1  300972942        aL(R)   17  13271</span>
<span class="go">2  300972942        a3(R)   17  13224</span>
<span class="go">3  300972942  MB(+ACA)(R)   17  13295</span>
<span class="go">4  300972942       SNP(R)  526    336</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_custom_neurons">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_custom_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/neurons.py#L147"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_custom_neurons" title="Link to this definition">¶</a></dt>
<dd><p>Return properties and per-ROI synapse counts for a set of neurons,
using your own cypher query.</p>
<p>Use a custom query to fetch a neuron table, with nicer output
than you would get from a call to <a class="reference internal" href="#neuprint.queries.fetch_custom" title="neuprint.queries.fetch_custom"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_custom()</span></code></a>.</p>
<p>Returns data in the the same format as <a class="reference internal" href="#neuprint.queries.fetch_neurons" title="neuprint.queries.fetch_neurons"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_neurons()</span></code></a>.
but allows you to provide your own cypher query logic
(subject to certain requirements; see below).</p>
<p>This function includes all Neuron fields in the results,
and also sends back ROI counts as a separate table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – <p>Custom query. Must match a neuron named <code class="docutils literal notranslate"><span class="pre">n</span></code>,
and must <code class="docutils literal notranslate"><span class="pre">RETURN</span> <span class="pre">n</span></code>.</p>
<div class="highlight-cypher notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="p">:</span><span class="n">Neuron</span><span class="p">)</span>
<span class="p">...</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">n</span>
<span class="p">...</span>
</pre></div>
</div>
</p></li>
<li><p><strong>client</strong> – If not provided, the global default <code class="docutils literal notranslate"><span class="pre">Client</span></code> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Two DataFrames.
<code class="docutils literal notranslate"><span class="pre">(neurons_df,</span> <span class="pre">roi_counts_df)</span></code></p>
<p>In <code class="docutils literal notranslate"><span class="pre">neurons_df</span></code>, all available columns <code class="docutils literal notranslate"><span class="pre">:Neuron</span></code> columns are returned, with the following changes:</p>
<blockquote>
<div><ul class="simple">
<li><p>ROI boolean columns are removed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> is parsed as json data</p></li>
<li><p>coordinates (such as <code class="docutils literal notranslate"><span class="pre">somaLocation</span></code>) are provided as a list <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z]</span></code></p></li>
<li><p>New columns <code class="docutils literal notranslate"><span class="pre">inputRoi</span></code> and <code class="docutils literal notranslate"><span class="pre">outputRoi</span></code> contain lists of each neuron’s ROIs.</p></li>
</ul>
</div></blockquote>
<p>In <code class="docutils literal notranslate"><span class="pre">roi_counts_df</span></code>, the <code class="docutils literal notranslate"><span class="pre">roiInfo</span></code> has been loaded into a table
of per-neuron-per-ROI synapse counts, with separate columns
for <code class="docutils literal notranslate"><span class="pre">pre</span></code> (outputs) and <code class="docutils literal notranslate"><span class="pre">post</span></code> (inputs).</p>
<p>Connections which fall outside of all primary ROIs are listed via special entries
using <code class="docutils literal notranslate"><span class="pre">NotPrimary</span></code> in place of an ROI name.  The term <code class="docutils literal notranslate"><span class="pre">NotPrimary</span></code> is
introduced by this function. It isn’t used internally by the neuprint database.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id5">
<h3>Connectivity<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_simple_connections">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_simple_connections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upstream_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rois</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['type',</span> <span class="pre">'instance']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/connectivity.py#L14"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_simple_connections" title="Link to this definition">¶</a></dt>
<dd><p>Find connections to/from small set(s) of neurons.  Most users
should prefer <code class="docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code> instead of this function.</p>
<p>Finds all connections from a set of “upstream” neurons,
or to a set of “downstream” neurons,
or all connections from a set of upstream neurons to a set of downstream neurons.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is not intended to be used with very large sets of neurons.
Furthermore, it does not return ROI information in a convenient format.
But the simple output table it returns is sometimes convenient for small,
interactive queries.</p>
<p>To fetch all adjacencies between a large set of neurons,
see <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>, which also has additional
ROI-filtering options, and also returns ROI info in a separate table.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upstream_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – How to filter for neurons on the presynaptic side of connections.</p></li>
<li><p><strong>downstream_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – How to filter for neurons on the postsynaptic side of connections.</p></li>
<li><p><strong>rois</strong> – Limit results to neuron pairs that connect in at least one of the given ROIs.
Note that the total weight of each connection may include connections outside of the listed ROIs, too.</p></li>
<li><p><strong>min_weight</strong> – Exclude connections whose total weight (across all ROIs) falls below this threshold.</p></li>
<li><p><strong>properties</strong> – Additional columns to include in the results, for both the upstream and downstream body.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame
One row per connection, with columns for upstream (pre-synaptic) and downstream (post-synaptic) properties.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_simple_connections</span>
<span class="gp">   ...: </span><span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="mi">329566174</span><span class="p">,</span> <span class="mi">425790257</span><span class="p">,</span> <span class="mi">424379864</span><span class="p">,</span> <span class="mi">329599710</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">425790257</span><span class="p">,</span> <span class="mi">424379864</span><span class="p">,</span> <span class="mi">329566174</span><span class="p">,</span> <span class="mi">329599710</span><span class="p">,</span> <span class="mi">420274150</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">fetch_simple_connections</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gh">Out[1]:</span>
<span class="go">   bodyId_pre  bodyId_post  weight                   type_pre                  type_post         instance_pre        instance_post                                       conn_roiInfo</span>
<span class="go">0   329566174    425790257      43                    OA-VPM3                        APL   OA-VPM3(NO2/NO3)_R                APL_R  {&#39;MB(R)&#39;: {&#39;pre&#39;: 39, &#39;post&#39;: 39}, &#39;b&#39;L(R)&#39;: {...</span>
<span class="go">1   329566174    424379864      37                    OA-VPM3                 AVM03e_pct   OA-VPM3(NO2/NO3)_R  AVM03e_pct(AVM03)_R  {&#39;SNP(R)&#39;: {&#39;pre&#39;: 34, &#39;post&#39;: 34}, &#39;SLP(R)&#39;: ...</span>
<span class="go">2   425790257    329566174      12                        APL                    OA-VPM3                APL_R   OA-VPM3(NO2/NO3)_R  {&#39;MB(R)&#39;: {&#39;pre&#39;: 12, &#39;post&#39;: 12}, &#39;gL(R)&#39;: {&#39;...</span>
<span class="go">3   424379864    329566174       7                 AVM03e_pct                    OA-VPM3  AVM03e_pct(AVM03)_R   OA-VPM3(NO2/NO3)_R  {&#39;SNP(R)&#39;: {&#39;pre&#39;: 5, &#39;post&#39;: 5}, &#39;SLP(R)&#39;: {&#39;...</span>
<span class="go">4   329599710    329566174       4  olfactory multi lvPN mALT                    OA-VPM3        mPNX(AVM06)_R   OA-VPM3(NO2/NO3)_R  {&#39;SNP(R)&#39;: {&#39;pre&#39;: 4, &#39;post&#39;: 4}, &#39;SIP(R)&#39;: {&#39;...</span>
<span class="go">5   329566174    329599710       1                    OA-VPM3  olfactory multi lvPN mALT   OA-VPM3(NO2/NO3)_R        mPNX(AVM06)_R  {&#39;SNP(R)&#39;: {&#39;pre&#39;: 1, &#39;post&#39;: 1}, &#39;SLP(R)&#39;: {&#39;...</span>
<span class="go">6   329566174    420274150       1                    OA-VPM3                 AVM03m_pct   OA-VPM3(NO2/NO3)_R  AVM03m_pct(AVM03)_R  {&#39;SNP(R)&#39;: {&#39;pre&#39;: 1, &#39;post&#39;: 1}, &#39;SLP(R)&#39;: {&#39;...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_adjacencies">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_adjacencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rois</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_roi_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_total_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_nonprimary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['type',</span> <span class="pre">'instance']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/connectivity.py#L138"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_adjacencies" title="Link to this definition">¶</a></dt>
<dd><p>Find connections to/from large sets of neurons, with per-ROI connection strengths.</p>
<p>Fetches the adjacency table for connections between sets of neurons, broken down by ROI.
Unless <code class="docutils literal notranslate"><span class="pre">include_nonprimary=True</span></code>, only primary ROIs are included in the per-ROI connection table.
Connections outside of the primary ROIs are labeled with the special name
<code class="docutils literal notranslate"><span class="pre">&quot;NotPrimary&quot;</span></code> (which is not currently an ROI name in neuprint itself).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_simple_connections()</span></code></a> has similar functionality,
but that function isn’t suitable for querying large sets of neurons.
However, it may be more convenient for small interactive queries.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sources</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Limit results to connections from bodies that match this criteria.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all neurons upstream of <code class="docutils literal notranslate"><span class="pre">targets</span></code> will be fetched.</p></li>
<li><p><strong>targets</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Limit results to connections to bodies that match this criteria.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all neurons downstream of <code class="docutils literal notranslate"><span class="pre">sources</span></code> will be fetched.</p></li>
<li><p><strong>rois</strong> – Limit results to connections within the listed ROIs.</p></li>
<li><p><strong>min_roi_weight</strong> – Limit results to connections of at least this strength within at least one of the returned ROIs.</p></li>
<li><p><strong>min_total_weight</strong> – <p>Limit results to connections that are at least this strong when totaled across all ROIs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if <code class="docutils literal notranslate"><span class="pre">min_roi_weight</span></code> is also specified, all connections are counted towards satisfying
the total weight threshold, even though some ROI entries are filtered out.
Therefore, some connections in the results may appear not to satisfy <code class="docutils literal notranslate"><span class="pre">min_total_weight</span></code>
when their per-ROI weights are totaled.  That’s just because you filtered out the weak
per-ROI entries.</p>
</div>
</p></li>
<li><p><strong>include_nonprimary</strong> – <p>If True, also list per-ROI totals for non-primary ROIs
(i.e. parts of the ROI hierarchy that are sub-primary or super-primary).
See <a class="reference internal" href="#neuprint.queries.fetch_roi_hierarchy" title="neuprint.queries.fetch_roi_hierarchy"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_roi_hierarchy()</span></code></a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since non-primary ROIs overlap with primary ROIs, then the sum of the
<code class="docutils literal notranslate"><span class="pre">weight</span></code> column for each body pair will not be equal to the total
connection strength between the bodies.
(Some connections will be counted twice.)</p>
</div>
</p></li>
<li><p><strong>export_dir</strong> – Optional. Export CSV files for the neuron table,
connection table (total weight), and connection table (per ROI).</p></li>
<li><p><strong>batch_size</strong> – For optimal performance, connections will be fetched in batches.
This parameter specifies the batch size.</p></li>
<li><p><strong>properties</strong> – Which Neuron properties to include in the output table.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two DataFrames, <code class="docutils literal notranslate"><span class="pre">(neurons_df,</span> <span class="pre">roi_conn_df)</span></code>, containing a
table of neuron IDs and the per-ROI connection table, respectively.
See caveat above concerning non-primary ROIs.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_simple_connections()</span></code></a>
<a class="reference internal" href="#neuprint.queries.fetch_traced_adjacencies" title="neuprint.queries.fetch_traced_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_traced_adjacencies()</span></code></a></p>
</div>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="gp">   ...: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;neuprint.janelia.org&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;hemibrain:v1.2.1&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_adjacencies</span>
<span class="gp">   ...: </span><span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="mi">329566174</span><span class="p">,</span> <span class="mi">425790257</span><span class="p">,</span> <span class="mi">424379864</span><span class="p">,</span> <span class="mi">329599710</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">425790257</span><span class="p">,</span> <span class="mi">424379864</span><span class="p">,</span> <span class="mi">329566174</span><span class="p">,</span> <span class="mi">329599710</span><span class="p">,</span> <span class="mi">420274150</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">neuron_df</span><span class="p">,</span> <span class="n">connection_df</span> <span class="o">=</span> <span class="n">fetch_adjacencies</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">neuron_df</span>
<span class="gh">Out[3]:</span>
<span class="go">      bodyId             instance                       type</span>
<span class="go">0  329566174   OA-VPM3(NO2/NO3)_R                    OA-VPM3</span>
<span class="go">1  329599710        mPNX(AVM06)_R  olfactory multi lvPN mALT</span>
<span class="go">2  424379864  AVM03e_pct(AVM03)_R                 AVM03e_pct</span>
<span class="go">3  425790257                APL_R                        APL</span>
<span class="go">4  420274150  AVM03m_pct(AVM03)_R                 AVM03m_pct</span>

<span class="gp">In [4]: </span><span class="n">connection_df</span>
<span class="gh">Out[4]:</span>
<span class="go">    bodyId_pre  bodyId_post     roi  weight</span>
<span class="go">0    329566174    329599710  SLP(R)       1</span>
<span class="go">1    329566174    420274150  SLP(R)       1</span>
<span class="go">2    329566174    424379864  SLP(R)      31</span>
<span class="go">3    329566174    424379864  SCL(R)       3</span>
<span class="go">4    329566174    424379864  SIP(R)       3</span>
<span class="go">5    329566174    425790257   gL(R)      17</span>
<span class="go">6    329566174    425790257   CA(R)      10</span>
<span class="go">7    329566174    425790257  CRE(R)       4</span>
<span class="go">8    329566174    425790257  b&#39;L(R)       3</span>
<span class="go">9    329566174    425790257   aL(R)       3</span>
<span class="go">10   329566174    425790257  PED(R)       3</span>
<span class="go">11   329566174    425790257   bL(R)       2</span>
<span class="go">12   329566174    425790257  a&#39;L(R)       1</span>
<span class="go">13   329599710    329566174  SLP(R)       3</span>
<span class="go">14   329599710    329566174  SIP(R)       1</span>
<span class="go">15   424379864    329566174  SLP(R)       4</span>
<span class="go">16   424379864    329566174  SCL(R)       2</span>
<span class="go">17   424379864    329566174  SIP(R)       1</span>
<span class="go">18   425790257    329566174   gL(R)       8</span>
<span class="go">19   425790257    329566174   CA(R)       3</span>
<span class="go">20   425790257    329566174   aL(R)       1</span>
</pre></div>
</div>
<p><strong>Total Connection Strength</strong></p>
<p>To aggregate the per-ROI connection weights into total connection weights, use <code class="docutils literal notranslate"><span class="pre">groupby(...)['weight'].sum()</span></code></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">connection_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;bodyId_pre&#39;</span><span class="p">,</span> <span class="s1">&#39;bodyId_post&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[5]:</span>
<span class="go">   bodyId_pre  bodyId_post  weight</span>
<span class="go">0   329566174    329599710       1</span>
<span class="go">1   329566174    420274150       1</span>
<span class="go">2   329566174    424379864      37</span>
<span class="go">3   329566174    425790257      43</span>
<span class="go">4   329599710    329566174       4</span>
<span class="go">5   424379864    329566174       7</span>
<span class="go">6   425790257    329566174      12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_traced_adjacencies">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_traced_adjacencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">export_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/connectivity.py#L641"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_traced_adjacencies" title="Link to this definition">¶</a></dt>
<dd><p>Convenience function that calls <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>
for all <code class="docutils literal notranslate"><span class="pre">Traced</span></code>, non-<code class="docutils literal notranslate"><span class="pre">cropped</span></code> neurons.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On the hemibrain dataset, this function takes a few minutes to run,
and the results are somewhat large (~300 MB).</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_traced_adjacencies</span>

<span class="gp">In [2]: </span><span class="n">neurons_df</span><span class="p">,</span> <span class="n">roi_conn_df</span> <span class="o">=</span> <span class="n">fetch_traced_adjacencies</span><span class="p">(</span><span class="s1">&#39;exported-connections&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">roi_conn_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[3]:</span>
<span class="go">       bodyId_pre  bodyId_post        roi  weight</span>
<span class="go">0      5813009352    516098538     SNP(R)       2</span>
<span class="go">1      5813009352    516098538     SLP(R)       2</span>
<span class="go">2       326119769    516098538     SNP(R)       1</span>
<span class="go">3       326119769    516098538     SLP(R)       1</span>
<span class="go">4       915960391    202916528         FB       1</span>

<span class="gp">In [4]: </span><span class="c1"># Obtain total weights (instead of per-connection-per-ROI weights)</span>
<span class="gp">   ...: </span><span class="n">conn_groups</span> <span class="o">=</span> <span class="n">roi_conn_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;bodyId_pre&#39;</span><span class="p">,</span> <span class="s1">&#39;bodyId_post&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">total_conn_df</span> <span class="o">=</span> <span class="n">conn_groups</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">total_conn_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[4]:</span>
<span class="go">   bodyId_pre  bodyId_post  weight</span>
<span class="go">0   202916528    203253253       2</span>
<span class="go">1   202916528    203257652       2</span>
<span class="go">2   202916528    203598557       2</span>
<span class="go">3   202916528    234292899       4</span>
<span class="go">4   202916528    264986706       2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_common_connectivity">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_common_connectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upstream'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['type',</span> <span class="pre">'instance']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/connectivity.py#L684"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_common_connectivity" title="Link to this definition">¶</a></dt>
<dd><p>Find shared connections among a set of neurons.</p>
<p>Given a set of neurons that match the given criteria, find neurons
that connect to ALL of the neurons in the set, i.e. connections
that are common to all neurons in the matched set.</p>
<p>This is the Python equivalent to the Neuprint Explorer <a class="reference external" href="https://neuprint.janelia.org/?dataset=hemibrain%3Av1.2.1&amp;qt=commonconnectivity&amp;q=1">Common Connectivity</a> page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Used to determine the match set, for which common connections will be found.</p></li>
<li><p><strong>search_direction</strong> (<code class="docutils literal notranslate"><span class="pre">&quot;upstream&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;downstream&quot;</span></code>) – Whether or not to search for common connections upstream of
the matched neurons or downstream of the matched neurons.</p></li>
<li><p><strong>min_weight</strong> – Connections below the given strength will not be included in the results.</p></li>
<li><p><strong>properties</strong> – Additional columns to include in the results, for both the upstream and downstream body.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame.
(Same format as returned by <a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_simple_connections()</span></code></a>.)
One row per connection, with columns for upstream and downstream properties.
For instance, if <code class="docutils literal notranslate"><span class="pre">search_direction=&quot;upstream&quot;</span></code>, then the matched neurons will appear
in the <code class="docutils literal notranslate"><span class="pre">_post</span></code> columns, and the common connections will appear in the <code class="docutils literal notranslate"><span class="pre">_pre</span></code>
columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_shortest_paths">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_shortest_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upstream_bodyId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_bodyId</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/connectivity.py#L748"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_shortest_paths" title="Link to this definition">¶</a></dt>
<dd><p>Find all neurons along the shortest path between two neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upstream_bodyId</strong> – The starting neuron</p></li>
<li><p><strong>downstream_bodyId</strong> – The destination neuron</p></li>
<li><p><strong>min_weight</strong> – Minimum connection strength for each step in the path.</p></li>
<li><p><strong>intermediate_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Filtering criteria for neurons on path.
All intermediate neurons in the path must satisfy this criteria.
By default, <code class="docutils literal notranslate"><span class="pre">NeuronCriteria(status=&quot;Traced&quot;)</span></code> is used.</p></li>
<li><p><strong>timeout</strong> – Give up after this many seconds, in which case an <strong>empty DataFrame is returned.</strong>
No exception is raised!</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All paths are concatenated into a single DataFrame.
The <cite>path</cite> column indicates which path that row belongs to.
The <cite>weight</cite> column indicates the connection strength to that
body from the previous body in the path.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_shortest_paths</span>
<span class="gp">   ...: </span><span class="n">fetch_shortest_paths</span><span class="p">(</span><span class="mi">329566174</span><span class="p">,</span> <span class="mi">294792184</span><span class="p">,</span> <span class="n">min_weight</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gh">Out[1]:</span>
<span class="go">      path     bodyId                       type  weight</span>
<span class="go">0        0  329566174                    OA-VPM3       0</span>
<span class="go">1        0  517169460                 PDL05h_pct      11</span>
<span class="go">2        0  297251714                ADM01om_pct      15</span>
<span class="go">3        0  294424196                PDL13ob_pct      11</span>
<span class="go">4        0  295133927               PDM18a_d_pct      10</span>
<span class="go">...    ...        ...                        ...     ...</span>
<span class="go">5773   962  511271574                 ADL24h_pct      43</span>
<span class="go">5774   962  480923210                PDL10od_pct      18</span>
<span class="go">5775   962  294424196                PDL13ob_pct      21</span>
<span class="go">5776   962  295133927               PDM18a_d_pct      10</span>
<span class="go">5777   962  294792184  olfactory multi vPN mlALT      10</span>

<span class="go">[5778 rows x 4 columns]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id6">
<h3>Synapses<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_synapses">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_synapses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/synapses.py#L15"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_synapses" title="Link to this definition">¶</a></dt>
<dd><p>Fetch synapses from a neuron or selection of neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuron_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Determines which bodies to fetch synapses for.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>synapse_criteria</strong> (<a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><em>SynapseCriteria</em></a>) – <p>Optional. Allows you to filter synapses by roi, type, confidence.
See <a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a> for details.</p>
<p>If the criteria specifies <code class="docutils literal notranslate"><span class="pre">primary_only=True</span></code> only primary ROIs will be returned in the results.
If a synapse does not intersect any primary ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.
(Since ‘primary’ ROIs do not overlap, each synapse will be listed only once.)
Otherwise, all ROI names will be included in the results.
In that case, some synapses will be listed multiple times – once per intersecting ROI.
If a synapse does not intersect any ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>batch_size</strong> – To improve performance and avoid timeouts, the synapses for multiple bodies
will be fetched in batches, where each batch corresponds to N bodies.
This argument sets the batch size N.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame in which each row represent a single synapse.
Unless <code class="docutils literal notranslate"><span class="pre">primary_only</span></code> was specified, some synapses may be listed more than once,
if they reside in more than one overlapping ROI.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">NeuronCriteria</span> <span class="k">as</span> <span class="n">NC</span><span class="p">,</span> <span class="n">SynapseCriteria</span> <span class="k">as</span> <span class="n">SC</span><span class="p">,</span> <span class="n">fetch_synapses</span>
<span class="gp">   ...: </span><span class="n">fetch_synapses</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ADL.*&#39;</span><span class="p">,</span> <span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FB&#39;</span><span class="p">]),</span>
<span class="gp">   ...: </span>               <span class="n">SC</span><span class="p">(</span><span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LH(R)&#39;</span><span class="p">,</span> <span class="s1">&#39;SIP(R)&#39;</span><span class="p">],</span> <span class="n">primary_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gh">Out[1]:</span>
<span class="go">        bodyId  type     roi      x      y      z  confidence</span>
<span class="go">0   5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">1   5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">2   5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">3   5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">4   5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">5   5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">6   5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">7   5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">8   5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">9   5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">10  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">11  5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">12  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">13  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">14  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">15  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">16  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">17  5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">18  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">19  5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">20  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">21  5812983094   pre   LH(R)   5434  21270  19201    0.995000</span>
<span class="go">22  5812983094   pre   LH(R)   5447  21281  19155    0.991000</span>
<span class="go">23  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">24  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">25  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">26  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">27  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">28  5812983094   pre  SIP(R)  15300  25268  14043    0.992000</span>
<span class="go">29   764377593  post   LH(R)   8043  21587  15146    0.804000</span>
<span class="go">30   764377593  post   LH(R)   8057  21493  15140    0.906482</span>
<span class="go">31   859152522   pre  SIP(R)  13275  25499  13629    0.997000</span>
<span class="go">32   859152522   pre  SIP(R)  13275  25499  13629    0.997000</span>
<span class="go">33   859152522  post  SIP(R)  13349  25337  13653    0.818386</span>
<span class="go">34   859152522  post  SIP(R)  12793  26362  14202    0.926918</span>
<span class="go">35   859152522   pre  SIP(R)  13275  25499  13629    0.997000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_mean_synapses">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_mean_synapses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_roi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/synapses.py#L199"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_mean_synapses" title="Link to this definition">¶</a></dt>
<dd><p>Fetch average synapse position and confidence for each neuron in set of neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuron_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Determines which bodies to fetch synapses for.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>synapse_criteria</strong> (<a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><em>SynapseCriteria</em></a>) – <p>Optional. Allows you to filter synapses by roi, type, confidence.
See <a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a> for details.</p>
<p>If the criteria specifies <code class="docutils literal notranslate"><span class="pre">primary_only=True</span></code> only primary ROIs will be returned in the results.
If a synapse does not intersect any primary ROI, it will be ignored by this function.</p>
</p></li>
<li><p><strong>batch_size</strong> – To improve performance and avoid timeouts, the synapses for multiple bodies
will be processed in batches, where each batch corresponds to N bodies.
This argument sets the batch size N.</p></li>
<li><p><strong>by_roi</strong> – <p>If <code class="docutils literal notranslate"><span class="pre">by_roi=True</span></code> (the default), return separate rows for each ROI in each neuron.
If <code class="docutils literal notranslate"><span class="pre">by_roi=False</span></code>, then return the mean for the entire neuron in each case,
without respect to ROI.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if <code class="docutils literal notranslate"><span class="pre">by_roi=False</span></code>, the set of averaged synapses will be restricted to the
ROIs listed in your <cite>synapse_critera</cite> (if any).</p>
</div>
</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame in which each row contains the average synapse position and average
confidence for a particular body, ROI, and synapse type (pre/post).</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_mean_synapses</span><span class="p">,</span> <span class="n">SynapseCriteria</span> <span class="k">as</span> <span class="n">SC</span>
<span class="gp">   ...: </span><span class="n">fetch_mean_synapses</span><span class="p">(</span><span class="s1">&#39;LC10&#39;</span><span class="p">,</span> <span class="n">SC</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LO(R)&#39;</span><span class="p">,</span> <span class="s1">&#39;AOTU(R)&#39;</span><span class="p">]))</span>
<span class="gh">Out[1]:</span>
<span class="go">        bodyId      roi type  count             x             y             z  confidence</span>
<span class="go">0    1017448980  AOTU(R)  pre    141  10691.737305  30304.355469  15508.099609    0.956000</span>
<span class="go">1    1017448980    LO(R)  pre      2   8530.500000  18898.000000  34857.000000    0.954500</span>
<span class="go">2    1017090133  AOTU(R)  pre     49  10560.469727  31032.041016  14548.550781    0.956286</span>
<span class="go">3    1017090133    LO(R)  pre     52   3737.115479  19489.923828  29530.000000    0.949673</span>
<span class="go">4    1017094185  AOTU(R)  pre    157  10922.248047  30326.693359  15349.484375    0.959185</span>
<span class="go">..          ...      ...  ...    ...           ...           ...           ...         ...</span>
<span class="go">772  1262602271    LO(R)  pre      3   5178.666504  14584.666992  23227.333984    0.957333</span>
<span class="go">773  1291573712  AOTU(R)  pre    273  11285.106445  31097.925781  15987.640625    0.954418</span>
<span class="go">774  1291573712    LO(R)  pre      3   6482.000000  13845.333008  25962.666016    0.936333</span>
<span class="go">775  5812993252  AOTU(R)  pre     17  11110.706055  30892.470703  17220.175781    0.960471</span>
<span class="go">776  5812993252    LO(R)  pre     39   7758.897461  11723.154297  28176.794922    0.943128</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_synapse_connections">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_synapse_connections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_total_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/synapses.py#L413"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_synapse_connections" title="Link to this definition">¶</a></dt>
<dd><p>Fetch synaptic-level connections between source and target neurons.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use this function if you need information about individual synapse connections,
such as their exact positions or confidence scores.
If you’re just interested in aggregate neuron-to-neuron connection info
(including connection strengths and ROI intersections), see
<a class="reference internal" href="#neuprint.queries.fetch_simple_connections" title="neuprint.queries.fetch_simple_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_simple_connections()</span></code></a> and <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>,
which are faster and have more condensed outputs than this function.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you experience timeouts while running this function,
try reducing the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> setting.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Criteria to by which to filter source (pre-synaptic) neurons.
If omitted, all Neurons will be considered as possible sources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>target_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Criteria to by which to filter target (post-synaptic) neurons.
If omitted, all Neurons will be considered as possible targets.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>synapse_criteria</strong> (<a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><em>SynapseCriteria</em></a>) – <p>Optional. Allows you to filter synapses by roi or confidence.
The same criteria is used to filter both <code class="docutils literal notranslate"><span class="pre">pre</span></code> and <code class="docutils literal notranslate"><span class="pre">post</span></code> sides
of the connection, except for the <code class="docutils literal notranslate"><span class="pre">rois</span></code> – see note below.
By default, <code class="docutils literal notranslate"><span class="pre">SynapseCriteria(primary_only=True)</span></code> is used,
with no additional filters.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">primary_only</span></code> is specified in the criteria, then the resulting
<code class="docutils literal notranslate"><span class="pre">roi_pre</span></code> and <code class="docutils literal notranslate"><span class="pre">roi_post</span></code> columns will contain a single
string (or <code class="docutils literal notranslate"><span class="pre">None</span></code>) in every row.</p>
<p>Otherwise, the roi columns will contain a list of ROIs for every row.
(Primary ROIs do not overlap, so every synapse resides in only one
(or zero) primary ROI.)
See <a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any <code class="docutils literal notranslate"><span class="pre">rois</span></code> specified in your <code class="docutils literal notranslate"><span class="pre">synapse_criteria</span></code> will be used to filter
the target (post-synaptic) side of the synapse connection, but not
the pre-synaptic side.  So in the rare cases where the pre and post synapses
reside on different sides of an ROI boundary, the connection is associated
with the post-synaptic ROI.</p>
<p>That’s consistent with neuprint’s conventions for ROI assignment in the
neuron-to-neuron <code class="docutils literal notranslate"><span class="pre">ConnectsTo:</span></code> relationship, and thus ensures that this function
returns synapse counts that are consistent with <a class="reference internal" href="#neuprint.queries.fetch_adjacencies" title="neuprint.queries.fetch_adjacencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_adjacencies()</span></code></a>.</p>
</div>
</p></li>
<li><p><strong>min_total_weight</strong> – <p>If the total weight of the connection between two bodies is not at least
this strong, don’t include the synapses for that connection in the results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This filters for total connection weight, regardless of the weight
within any particular ROI.  So, if your <code class="docutils literal notranslate"><span class="pre">SynapseCriteria</span></code> limits
results to a particular ROI, but two bodies connect in multiple ROIs,
then the number of synapses returned for the two bodies may appear to
be less than <code class="docutils literal notranslate"><span class="pre">min_total_weight</span></code>. That’s because you filtered out
the synapses in other ROIs.</p>
</div>
</p></li>
<li><p><strong>batch_size</strong> – To avoid timeouts and improve performance, the synapse connections
will be fetched in batches.  The batching strategy is to process
each body one at a time, and if it has lots of connection partners,
split the request across several batches to avoid timeouts that
could arise from a large request.
This argument specifies the maximum size of each batch in the inner loop.
Larger batches are more efficient to fetch, but increase the likelihood
of timeouts.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>DataFrame in which each row represents a single synaptic connection
between an upstream (pre-synaptic) body and downstream (post-synaptic) body.</p>
<p>Synapse locations are listed in columns <code class="docutils literal notranslate"><span class="pre">[x_pre,</span> <span class="pre">y_pre,</span> <span class="pre">z_pre]</span></code> and
<code class="docutils literal notranslate"><span class="pre">[x_post,</span> <span class="pre">y_post,</span> <span class="pre">z_post]</span></code> for the upstream and downstream synapses,
respectively.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">roi_pre</span></code> and <code class="docutils literal notranslate"><span class="pre">roi_post</span></code> columns will contain either strings
or lists-of-strings, depending on the <code class="docutils literal notranslate"><span class="pre">primary_only</span></code> synapse criteria as
described above.</p>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_synapse_connections</span><span class="p">,</span> <span class="n">SynapseCriteria</span> <span class="k">as</span> <span class="n">SC</span>
<span class="gp">   ...: </span><span class="n">fetch_synapse_connections</span><span class="p">(</span><span class="mi">792368888</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">SC</span><span class="p">(</span><span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PED(R)&#39;</span><span class="p">,</span> <span class="s1">&#39;SMP(R)&#39;</span><span class="p">],</span> <span class="n">primary_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gh">Out[1]:</span>
<span class="go">    bodyId_pre  bodyId_post roi_pre roi_post  x_pre  y_pre  z_pre  x_post  y_post  z_post  confidence_pre  confidence_post</span>
<span class="go">0    792368888    754547386  PED(R)   PED(R)  14013  27747  19307   13992   27720   19313           0.996         0.401035</span>
<span class="go">1    792368888    612742248  PED(R)   PED(R)  14049  27681  19417   14044   27662   19408           0.921         0.881487</span>
<span class="go">2    792368888   5901225361  PED(R)   PED(R)  14049  27681  19417   14055   27653   19420           0.921         0.436177</span>
<span class="go">3    792368888   5813117385  SMP(R)   SMP(R)  23630  29443  16297   23634   29437   16279           0.984         0.970746</span>
<span class="go">4    792368888   5813083733  SMP(R)   SMP(R)  23630  29443  16297   23634   29419   16288           0.984         0.933871</span>
<span class="go">5    792368888   5813058320  SMP(R)   SMP(R)  18662  34144  12692   18655   34155   12697           0.853         0.995000</span>
<span class="go">6    792368888   5812981989  PED(R)   PED(R)  14331  27921  20099   14351   27928   20085           0.904         0.877373</span>
<span class="go">7    792368888   5812981381  PED(R)   PED(R)  14331  27921  20099   14301   27919   20109           0.904         0.567321</span>
<span class="go">8    792368888   5812981381  PED(R)   PED(R)  14013  27747  19307   14020   27747   19285           0.996         0.697836</span>
<span class="go">9    792368888   5812979314  PED(R)   PED(R)  14331  27921  20099   14329   27942   20109           0.904         0.638362</span>
<span class="go">10   792368888    424767514  PED(R)   PED(R)  14331  27921  20099   14324   27934   20085           0.904         0.985734</span>
<span class="go">11   792368888    424767514  PED(R)   PED(R)  14013  27747  19307   14020   27760   19294           0.996         0.942831</span>
<span class="go">12   792368888    424767514  PED(R)   PED(R)  14049  27681  19417   14040   27663   19420           0.921         0.993586</span>
<span class="go">13   792368888    331662710  SMP(R)   SMP(R)  23630  29443  16297   23644   29429   16302           0.984         0.996389</span>
<span class="go">14   792368888   1196854070  PED(R)   PED(R)  14331  27921  20099   14317   27935   20101           0.904         0.968408</span>
<span class="go">15   792368888   1131831702  SMP(R)   SMP(R)  23630  29443  16297   23651   29434   16316           0.984         0.362952</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id7">
<h3>Mitochondria<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_mitochondria">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_mitochondria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mito_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/mito.py#L16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_mitochondria" title="Link to this definition">¶</a></dt>
<dd><p>Fetch mitochondria from a neuron or selection of neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuron_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Determines which bodies from which to fetch mitochondria.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which mitochondria are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>mito_criteria</strong> (<a class="reference internal" href="mitocriteria.html#neuprint.queries.MitoCriteria" title="neuprint.queries.MitoCriteria"><em>MitoCriteria</em></a>) – <p>Optional. Allows you to filter mitochondria by roi, mitoType, size.
See <a class="reference internal" href="mitocriteria.html#neuprint.queries.MitoCriteria" title="neuprint.queries.MitoCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">MitoCriteria</span></code></a> for details.</p>
<p>If the criteria specifies <code class="docutils literal notranslate"><span class="pre">primary_only=True</span></code> only primary ROIs will be returned in the results.
If a mitochondrion does not intersect any primary ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.
(Since ‘primary’ ROIs do not overlap, each mitochondrion will be listed only once.)
Otherwise, all ROI names will be included in the results.
In that case, some mitochondria will be listed multiple times – once per intersecting ROI.
If a mitochondria does not intersect any ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>batch_size</strong> – To improve performance and avoid timeouts, the mitochondria for multiple bodies
will be fetched in batches, where each batch corresponds to N bodies.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame in which each row represent a single synapse.
If <code class="docutils literal notranslate"><span class="pre">primary_only=False</span></code> was specified in <code class="docutils literal notranslate"><span class="pre">mito_criteria</span></code>, some mitochondria
may be listed more than once, if they reside in more than one overlapping ROI.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">NeuronCriteria</span> <span class="k">as</span> <span class="n">NC</span><span class="p">,</span> <span class="n">SynapseCriteria</span> <span class="k">as</span> <span class="n">SC</span><span class="p">,</span> <span class="n">fetch_synapses</span>
<span class="gp">   ...:</span>
<span class="gp">   ...: </span><span class="c1"># Consider only neurons which innervate EB</span>
<span class="gp">   ...: </span><span class="n">nc</span> <span class="o">=</span> <span class="n">NC</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ExR.*&#39;</span><span class="p">,</span> <span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EB&#39;</span><span class="p">])</span>
<span class="gp">   ...:</span>
<span class="gp">   ...: </span><span class="c1"># But return only large mitos from those neurons that reside in the FB or LAL(R)</span>
<span class="gp">   ...: </span><span class="n">mc</span> <span class="o">=</span> <span class="n">MC</span><span class="p">(</span><span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FB&#39;</span><span class="p">,</span> <span class="s1">&#39;LAL(R)&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">100_000</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">fetch_mitochondria</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">mc</span><span class="p">)</span>
<span class="gh">Out[1]:</span>
<span class="go">          bodyId mitoType     roi      x      y      z     size          r0         r1        r2</span>
<span class="go">0     1136865339     dark  LAL(R)  15094  30538  23610   259240  101.586632  31.482559  0.981689</span>
<span class="go">1     1136865339     dark  LAL(R)  14526  30020  23464   297784   67.174950  36.328964  0.901079</span>
<span class="go">2     1136865339     dark  LAL(R)  15196  30386  23336   133168   54.907104  25.761894  0.912385</span>
<span class="go">3     1136865339     dark  LAL(R)  14962  30126  23184   169776   66.780258  27.168915  0.942389</span>
<span class="go">4     1136865339     dark  LAL(R)  15004  30252  23164   148528   69.316467  24.082989  0.951892</span>
<span class="go">...          ...      ...     ...    ...    ...    ...      ...         ...        ...       ...</span>
<span class="go">2807  1259386264     dark      FB  18926  24632  21046   159184   99.404472  21.919170  0.984487</span>
<span class="go">2808  1259386264     dark      FB  22162  24474  22486   127968   94.380531  20.547171  0.985971</span>
<span class="go">2809  1259386264   medium      FB  19322  24198  21952  1110888  116.050323  66.010017  0.954467</span>
<span class="go">2810  1259386264     dark      FB  19272  23632  21728   428168   87.865768  40.370171  0.944690</span>
<span class="go">2811  1259386264     dark      FB  19208  23442  21602   141928   53.694149  29.956501  0.919831</span>

<span class="go">[2812 rows x 10 columns]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_synapses_and_closest_mitochondria">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_synapses_and_closest_mitochondria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/mito.py#L186"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_synapses_and_closest_mitochondria" title="Link to this definition">¶</a></dt>
<dd><p>Fetch a set of synapses from a selection of neurons and also return
their nearest mitocondria (by path-length within the neuron segment).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some synapses have no nearby mitochondria, possibly due to
fragmented segmentation around the synapse point.
Such synapses ARE NOT RETURNED by this function. They’re omitted.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuron_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Determines which bodies to fetch synapses for.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>synapse_criteria</strong> (<a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><em>SynapseCriteria</em></a>) – <p>Optional. Allows you to filter synapses by roi, type, confidence.
See <a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a> for details.</p>
<p>If the criteria specifies <code class="docutils literal notranslate"><span class="pre">primary_only=True</span></code> only primary ROIs will be returned in the results.
If a synapse does not intersect any primary ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.
(Since ‘primary’ ROIs do not overlap, each synapse will be listed only once.)
Otherwise, all ROI names will be included in the results.
In that case, some synapses will be listed multiple times – once per intersecting ROI.
If a synapse does not intersect any ROI, it will be listed with an roi of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>batch_size</strong> – To improve performance and avoid timeouts, the synapses for multiple bodies
will be fetched in batches, where each batch corresponds to N bodies.
This argument sets the batch size N.</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>DataFrame in which each row represent a single synapse,
along with information about its closest mitochondrion.
Unless <code class="docutils literal notranslate"><span class="pre">primary_only</span></code> was specified, some synapses may be listed more than once,
if they reside in more than one overlapping ROI.</p>
<p>The synapse coordinates will be returned in columns <code class="docutils literal notranslate"><span class="pre">x,y,z</span></code>,
and the mitochondria centroids will be stored in columns <code class="docutils literal notranslate"><span class="pre">mx,my,mz</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">distance</span></code> column indicates the distance from the synapse coordinate to the
nearest edge of the mitochondria (not the centroid), as traveled along the neuron
dendrite (not euclidean distance).  The distance is given in voxel units (e.g. 8nm),
not nanometers.  See release notes concerning the estimated error of these measurements.</p>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">neuprint</span> <span class="kn">import</span> <span class="n">fetch_synapses_and_closest_mitochondria</span><span class="p">,</span> <span class="n">NeuronCriteria</span> <span class="k">as</span> <span class="n">NC</span><span class="p">,</span> <span class="n">SynapseCriteria</span> <span class="k">as</span> <span class="n">SC</span>
<span class="gp">   ...: </span><span class="n">fetch_synapses_and_closest_mitochondria</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ExR2&#39;</span><span class="p">),</span> <span class="n">SC</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pre&#39;</span><span class="p">))</span>
<span class="gh">Out[1]:</span>
<span class="go">          bodyId type     roi      x      y      z  confidence mitoType    distance    size     mx     my     mz          r0         r1        r2</span>
<span class="go">0     1136865339  pre      EB  25485  22873  19546       0.902   medium  214.053040  410544  25544  23096  19564  105.918625  35.547806  0.969330</span>
<span class="go">1     1136865339  pre      EB  25985  25652  23472       0.930     dark   19.313709   90048  26008  25646  23490   81.459419  21.493509  0.988575</span>
<span class="go">2     1136865339  pre  LAL(R)  14938  29149  22604       0.826     dark  856.091736  495208  14874  29686  22096   64.086639  46.906826  0.789570</span>
<span class="go">3     1136865339  pre      EB  24387  23583  20681       0.945     dark   78.424950  234760  24424  23536  20752   80.774353  29.854616  0.957713</span>
<span class="go">4     1136865339  pre   BU(R)  16909  25233  17658       0.994     dark  230.588562  215160  16862  25418  17824   42.314690  36.891937  0.628753</span>
<span class="go">...          ...  ...     ...    ...    ...    ...         ...      ...         ...     ...    ...    ...    ...         ...        ...       ...</span>
<span class="go">4508   787762461  pre   BU(R)  16955  26697  17300       0.643     dark  105.765854  176952  16818  26642  17200   91.884338  22.708199  0.975422</span>
<span class="go">4509   787762461  pre  LAL(R)  15008  28293  25995       0.747     dark  112.967644  446800  15044  28166  26198  176.721512  27.971079  0.992517</span>
<span class="go">4510   787762461  pre      EB  23468  24073  20882       0.757     dark  248.562714   92536  23400  23852  20760   39.696674  27.490204  0.860198</span>
<span class="go">4511   787762461  pre   BU(R)  18033  25846  20393       0.829     dark   38.627419  247640  18028  25846  20328   73.585144  29.661413  0.929788</span>
<span class="go">4512   787762461  pre      EB  22958  24565  20340       0.671     dark  218.104736  120880  23148  24580  20486   39.752777  32.047478  0.821770</span>

<span class="go">[4513 rows x 16 columns]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_connection_mitochondria">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_connection_mitochondria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synapse_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_total_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/mito.py#L391"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_connection_mitochondria" title="Link to this definition">¶</a></dt>
<dd><p>For a given set of source neurons and target neurons, find all
synapse-level connections between the sources and targets, along
with the nearest mitochondrion on the pre-synaptic side and the
post-synaptic side.</p>
<p>Returns a table similar to <a class="reference internal" href="#neuprint.queries.fetch_synapse_connections" title="neuprint.queries.fetch_synapse_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_synapse_connections()</span></code></a>, but with
extra <code class="docutils literal notranslate"><span class="pre">_pre</span></code> and <code class="docutils literal notranslate"><span class="pre">_post</span></code> columns to describe the nearest mitochondria
to the pre/post synapse in the connection.
If a given synapse has no nearby mitochondrion, the corresponding
mito columns will be populated with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values. (This is typically
much more likely to occur on the post-synaptic side than the pre-synaptic side.)</p>
<p>Arguments are the same as <a class="reference internal" href="#neuprint.queries.fetch_synapse_connections" title="neuprint.queries.fetch_synapse_connections"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_synapse_connections()</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not employ a custom cypher query to minimize the
data fetched from the server. Instead, it makes multiple calls to the
server and merges the results on the client.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Criteria to by which to filter source (pre-synaptic) neurons.
If omitted, all Neurons will be considered as possible sources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>target_criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – <p>Criteria to by which to filter target (post-synaptic) neurons.
If omitted, all Neurons will be considered as possible sources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any ROI criteria specified in this argument does not affect
which synapses are returned, only which bodies are inspected.</p>
</div>
</p></li>
<li><p><strong>synapse_criteria</strong> (<a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><em>SynapseCriteria</em></a>) – <p>Optional. Allows you to filter synapses by roi, type, confidence.
The same criteria is used to filter both <code class="docutils literal notranslate"><span class="pre">pre</span></code> and <code class="docutils literal notranslate"><span class="pre">post</span></code> sides
of the connection.
By default, <code class="docutils literal notranslate"><span class="pre">SynapseCriteria(primary_only=True)</span></code> is used.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">primary_only</span></code> is specified in the criteria, then the resulting
<code class="docutils literal notranslate"><span class="pre">roi_pre</span></code> and <code class="docutils literal notranslate"><span class="pre">roi_post</span></code> columns will contain a single
string (or <code class="docutils literal notranslate"><span class="pre">None</span></code>) in every row.</p>
<p>Otherwise, the roi columns will contain a list of ROIs for every row.
(Primary ROIs do not overlap, so every synapse resides in only one
(or zero) primary ROI.)
See <a class="reference internal" href="synapsecriteria.html#neuprint.queries.SynapseCriteria" title="neuprint.queries.SynapseCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseCriteria</span></code></a> for details.</p>
</p></li>
<li><p><strong>min_total_weight</strong> – <p>If the total weight of the connection between two bodies is not at least
this strong, don’t include the synapses for that connection in the results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This filters for total connection weight, regardless of the weight
within any particular ROI.  So, if your <code class="docutils literal notranslate"><span class="pre">SynapseCriteria</span></code> limits
results to a particular ROI, but two bodies connect in multiple ROIs,
then the number of synapses returned for the two bodies may appear to
be less than <code class="docutils literal notranslate"><span class="pre">min_total_weight</span></code>. That’s because you filtered out
the synapses in other ROIs.</p>
</div>
</p></li>
<li><p><strong>client</strong> – If not provided, the global default <a class="reference internal" href="client.html#neuprint.client.Client" title="neuprint.client.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id8">
<h3>Reconstruction Tools<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_output_completeness">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_output_completeness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_statuses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Traced']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/recon.py#L12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_output_completeness" title="Link to this definition">¶</a></dt>
<dd><p>Compute an estimate of “output completeness” for a set of neurons.
Output completeness is defined as the fraction of post-synaptic
connections which belong to ‘complete’ neurons, as defined by their status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Defines the set of neurons for which output completeness should be computed.</p></li>
<li><p><strong>complete_statuses</strong> – A list of neuron statuses should be considered complete for the purposes of this function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>DataFrame with columns <code class="docutils literal notranslate"><span class="pre">['bodyId',</span> <span class="pre">'completeness',</span> <span class="pre">'traced_weight',</span> <span class="pre">'untraced_weight',</span> <span class="pre">'total_weight']</span></code></p>
<p>For the purposes of these results, any statuses in the
set of complete_statuses are considered ‘traced’.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuprint.queries.fetch_downstream_orphan_tasks">
<span class="sig-prename descclassname"><span class="pre">neuprint.queries.</span></span><span class="sig-name descname"><span class="pre">fetch_downstream_orphan_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_statuses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Traced']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/connectome-neuprint/neuprint-python/blob/0.5.1/neuprint/queries/recon.py#L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuprint.queries.fetch_downstream_orphan_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Fetch the set of “downstream orphans” for a given set of neurons.</p>
<p>Returns a single DataFrame, where the downstream orphans have
been sorted by the weight of the connection, and their cumulative
contributions to the overall output-completeness of the upstream
neuron is also given.</p>
<p>That is, if you started tracing orphans from this DataFrame in
order, then the <code class="docutils literal notranslate"><span class="pre">cum_completeness</span></code> column indicates how complete
the upstream body is after each orphan becomes traced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>criteria</strong> (bodyId(s), type/instance, or <a class="reference internal" href="neuroncriteria.html#neuprint.queries.NeuronCriteria" title="neuprint.queries.NeuronCriteria"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronCriteria</span></code></a>) – Determines the set of “upstream” bodies for which
downstream orphans should be identified.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame, where <code class="docutils literal notranslate"><span class="pre">bodyId_pre</span></code> contains the upstream bodies you specified
via <code class="docutils literal notranslate"><span class="pre">criteria</span></code>, and <code class="docutils literal notranslate"><span class="pre">bodyId_post</span></code> contains the list of downstream orphans.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">orphan_tasks</span> <span class="o">=</span> <span class="n">fetch_downstream_orphan_tasks</span><span class="p">(</span><span class="n">NC</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;Traced&#39;</span><span class="p">,</span> <span class="n">cropped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rois</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PB&#39;</span><span class="p">]))</span>

<span class="gp">In [1]: </span><span class="n">orphan_tasks</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;cum_completeness &lt; 0.2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gh">Out[1]:</span>
<span class="go">       bodyId_pre  bodyId_post  orphan_weight status_post  total_weight  orig_traced_weight  orig_untraced_weight  orig_completeness  cum_orphan_weight  cum_completeness</span>
<span class="go">6478    759685279    759676733              2      Assign          7757                1427                  6330           0.183963                  2          0.184221</span>
<span class="go">8932    759685279    913193340              1        None          7757                1427                  6330           0.183963                  3          0.184350</span>
<span class="go">8943    759685279    913529796              1        None          7757                1427                  6330           0.183963                  4          0.184479</span>
<span class="go">8950    759685279    913534416              1        None          7757                1427                  6330           0.183963                  5          0.184607</span>
<span class="go">12121  1002507170   1387701052              1        None           522                 102                   420           0.195402                  1          0.197318</span>
<span class="go">35764   759685279    790382544              1        None          7757                1427                  6330           0.183963                  6          0.184736</span>
<span class="go">36052   759685279    851023555              1      Assign          7757                1427                  6330           0.183963                  7          0.184865</span>
<span class="go">36355   759685279    974908767              2        None          7757                1427                  6330           0.183963                  9          0.185123</span>
<span class="go">36673   759685279   1252526211              1        None          7757                1427                  6330           0.183963                 10          0.185252</span>
<span class="go">44840   759685279   1129418900              1        None          7757                1427                  6330           0.183963                 11          0.185381</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="client.html" class="btn btn-neutral float-left" title="Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="simulation.html" class="btn btn-neutral float-right" title="Simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, FlyEM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>